<script type="text/javascript" src="pages/security/security.js"></script>

<div class="col_6">
	<h4>Security</h4>
	<blockquote>
	<p>
	A basic check that the security is consistent with the server specification.
	</p>
	
	<ul>
		<li>AJAX with csrf.js includes the csrf.js script and then accesses a CSRF protected URL provided by the user. The user is responsible for defining a resource that is CSRF protected and returns the following JSON object: {"test" : "PrezoServer"}</li>
		<li>AJAX without csrf.js does not include the csrf.js script and then accesses a CSRF protected URL provided by the user as described above. It tests that an attempt to access the resource causes the server to respond with the expected error status code and message.</li>
	</ul>
	</blockquote>
</div>

<div class="col_6">
	<h4>Tests</h4>
	<blockquote>
		<div id="ajax_with_csrf_check" class="notice warning">
			<i id="ajax_with_csrf_check_icon" class="icon-check-empty"></i>
			<div id="ajax_with_csrf_check_message"></div>
		</div>
		
		<div id="ajax_with_no_csrf_check" class="notice warning">
			<i id="ajax_with_no_csrf_check_icon" class="icon-check-empty"></i>
			<div id="ajax_with_no_csrf_check_message"></div>
		</div>	
	
		<label id="endpoint_label" for="endpoint">CSRF protected resource (required):</label>
		<br />
		<select id="endpoint_select">
			<option value="">-- Choose --</option>
			<option value="api/csrf-test.json.jsp">api/csrf-test.json.jsp (Java implementation)</option>
			<option value="api/csrf-test.json.php">api/csrf-test.json.php (PHP implementation)</option>
			<option value="api/csrf-test.json.asp">api/csrf-test.json.asp (IIS implementation)</option>
			<option value="Other">Other (specify path below)</option>
		</select>
		<br />
		<input id="endpoint" name="endpoint" class="hide" type="text" size="25" />		
		<br />
		<button id="run_button" class="medium green pill"><i class="icon-play-circle"></i> Run tests</button>
	</blockquote>
</div>
